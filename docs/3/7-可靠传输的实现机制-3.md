![image-20220319121535282](https://gitee.com/pj-l/imgs-1/raw/master/image-20220319121535282.png)

## 可靠传输的实现机制之（选择重传协议 SR（`S`elective `R`equest））

- 假设采用 3 个比特给数据分组编序号，则序号的取值范围是 [0, 7]

- 发送窗口的尺寸 WT 的取值范围是 [2, 2^(3-1)]，即：[2, 4]，其中的 3 是构成分组的比特数量

- 本例取 WT 的值为 4

- 如下图所示，序号落在发送窗口内的 4 个数据分组可以连续发送，而序号落在发送窗口外的数据分组不允许发送

- 一般情况下，接收窗口的尺寸 WR 的取值可与发送窗口的尺寸 WT 的取值相同

- 故本例取 WR 的值为 4

- 如图所示，序号落在接收窗口内的 4 个数据分组允许接收，而序号落在接收窗口外的数据分组不允许接收

![image-20220319162413867](https://gitee.com/pj-l/imgs-1/raw/master/image-20220319162413867.png)

- 发送方将序号落在发送窗口内的这 4 个数据分组依次连续发送出去

![image-20220319221008763](https://gitee.com/pj-l/imgs-1/raw/master/image-20220319221008763.png)

- 它们经过互联网的传输陆续到达接收方，但其中的 2 号数据分组丢失了

![image-20220319221311622](https://gitee.com/pj-l/imgs-1/raw/master/image-20220319221311622.png)

- 只要序号落入接收窗口内并且没有误码的数据分组，接收方都会接收

- 接收方首先接收 0 号和 1 号数据分组，并发送与之对应的确认分组

- 接收窗口向前滑动两个位置，这样就有 4 和 5 两个新的序号落入接收窗口

![image-20220319221511342](https://gitee.com/pj-l/imgs-1/raw/master/image-20220319221511342.png)

- 然后，接收方接收 3 号数据分组，并发送与之对应的确认分组

- 但接收窗口不能向前滑动

![image-20220319221832164](https://gitee.com/pj-l/imgs-1/raw/master/image-20220319221832164.png)
