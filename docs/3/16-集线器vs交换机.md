#### 早期的「总线型以太网」

![image-20220326200244624](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-picgo/image-20220326200244624.png)

- 最初使用「粗同轴电缆」作为传输媒体

- 后来演进到使用价格相对便宜的「细同轴电缆」作为传输媒体

![image-20220326201108879](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-picgo/image-20220326201108879.png)

> 然而，这种使用（无源电缆 & 大量机械接头）的总线型以太网，并不像人们想象的那么可靠

#### 后来

- 在以太网领域，诞生了一种（工作在物理层 & 使用大规模集成电路 & 可靠性高）的设备，叫**集线器（HUB）**；人们使用**双绞线**作为传输媒体

	- 集线器的每个接口仅是简单地转发比特，而碰撞检测的任务由各站的网卡负责

	- 集线器一般拥有少量的（容错能力 & 网络管理功能）

		- 比如：若网络中某个网卡出现了故障，不停地发送帧，集线器是可以检测到这个问题的；集线器会在内部断开与出故障网卡的连线，以保障整个以太网仍能正常工作

> 实践证明，相比于使用具有大量机械接头的无源电缆；使用（集线器 & 双绞线）不但价格更便宜，而且使用起来也更加（灵活方便 & 稳定可靠）！

#### 举个例子

- 下图的以太网，使用集线器和双绞线电缆互连了 4 台主机

- （主机中的以太网卡 & 集线器的各接口），使用 RJ-45 插座

- 双绞线电缆的两端是 RJ-45 插头，也就是俗称的“水晶头”

<img src="https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-picgo/image-20220326202028357.png" alt="image-20220326202028357" style="zoom:50%;" />

- 该以太网物理上是星型拓扑结构

- 但逻辑上仍是一个总线网（信号广播），各站共享总线资源（争抢总线、可能碰撞），且使用 CSMA/CD 协议（协调各主机）

- 因此：在分析问题时，我们可将集线器简单地看作一条总线

#### 在物理层，用集线器扩展以太网的应用举例

- 假设某学院下设有 3 个系，且每个系都有 1 个（使用集线器作为互连设备的）以太网

- 这 3 个以太网相互独立，称为 3 个碰撞域（冲突域）

![image-20220326225400658](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-picgo/image-20220326225400658.png)

- 假设 1 系中的某台主机要给 1 系中的另一台主机发送数据帧，则由于总线特性，表示该数据帧的信号会被传输到 1 系中的其它各主机（广播）

- 假设 2 系中的多台主机同时发送数据帧，则由于总线特性，必然导致信号碰撞，**且碰撞后的信号会被传输到 2 系中的各主机**

![image-20220326225817637](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-picgo/image-20220326225817637.png)

- 为了使各个系的以太网能相互通信，可再加 1 个集线器，如下图

![image-20220326230000780](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-picgo/image-20220326230000780.png)

- 如此一来

	- 原本各自独立的 3 个以太网，就互连形成了 1 个更大的以太网

	- 原本各自独立的 3 个碰撞域，就合并形成了 1 个更大的碰撞域

![image-20220326230230171](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-picgo/image-20220326230230171.png)

> 即：形成了 1 个更大的逻辑上的总线型以太网

- 因此，假设 1 系中的某台主机要给 2 系中的某台主机发送数据帧，则表示该数据帧的信号会被广播到整个网络中的其它各个主机

![image-20220326230433297](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-picgo/image-20220326230433297.png)

#### 后来

- 在以太网领域，诞生了一种更先进的（工作在数据链路层和物理层）的网络互连设备 => 以太网交换机

- 以太网交换机通常拥有多个接口，且这些接口的速率不尽相同（eg：10Mbps、100Mbps、1Gbps、10Gbps、...）

- 这些接口都可以通过双绞线电缆，与其它（主机 || 以太网交换机）相连

- 以太网交换机拥有「并行性」，它能同时连通多对接口，使多对主机能同时通信，而无碰撞

- 以太网交换机收到数据帧后，会在自身的**帧交换表**中查找收到的数据帧的目的 MAC 地址所对应的接口号，然后通过该接口转发帧

- 以太网交换机是一种即插即用的设备，上电即可工作，其内部的帧交换表是通过**自学习算法**自动地逐渐建立起来的

- 大多数以太网交换机采用存储转发方式转发收到的数据帧，但也有一些交换机采用直通交换方式转发收到的数据帧

- 直通交换方式一般采用基于硬件的交叉矩阵，其在接收帧的同时就立即按帧的目的 MAC 地址决定该帧的转发接口进而转发（而不必把整个帧先缓存再处理）

- 因而直通交换方式提高了帧的转发速率，交换时延非常小

- 但是，直通交换方式并不检查帧是否有差错

#### 集线器 vs 交换机

- 使用集线器的以太网只能工作在「半双工」模式（即：发送帧和接收帧不能同时进行）

- 使用交换机的以太网一般工作在「全双工」方式（即：发送帧和接收帧可同时进行）

#### 集线器 vs 交换机

> 为简单起见，在这里，我们（忽略 ARP 过程，且假设交换机的帧交换表已经“学习好了”）

- 举个例子

	![image-20220326231303193](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-picgo/image-20220326231303193.png)

	- 使用集线器（HUB）互连而成的共享总线式以太网上的某台主机，要向该以太网上的另一台主机发送单播帧

		- 则该单播帧会通过共享总线**广播**到总线上的其它各个主机

	- 使用交换机（SWITCH）互连而成的交换式以太网上的某台主机，要向该以太网上的另一台主机发送单播帧

		- 单播帧进入交换机后，会被直接**转发**给目的主机

> 显然，交换机具有明显的优势 ！

#### 集线器 vs 交换机

> 为简单起见，在这里，我们（忽略 ARP 过程，且假设交换机的帧交换表已经“学习好了”）

- 对于使用集线器的共享总线型以太网，集线器收到单播帧后，单播帧会广播到总线上的其它各主机，各主机中的网卡，会根据帧的目的 MAC 地址来决定是否接受该帧

- 对于使用交换机的以太网，交换机收到单播帧后，会根据（帧的目的 MAC 地址 & 自身的帧交换表）将帧转发给目的主机

<img src="https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-picgo/image-20220327123653884.png" alt="image-20220327123653884" style="zoom:50%;" />



















