#### 电信网的诞生

> 电话问世后不久，人们发现，要让所有的电话都两两直接相连是不现实的

- 两部电话要直接相连，需要 1 条电线

- 五部电话要两两直接相连，需要 10 条电线

...

- n 部电话要两两直接相连，需要 C_n^2 / A_2^2 条电线，即 (n * (n - 1)) / (2 * 1) 条电线（高中排列组合的知识）

![image-20220301150819843](https://gitee.com/pj-l/imgs-1/raw/master/image-20220301150819843.png)

> 于是人们认识到需要一个中间设备将这些电话连接起来，这个中间设备就是**电话交换机**

<img src="https://gitee.com/pj-l/imgs-1/raw/master/image-20220301151056150.png" alt="image-20220301151056150" style="zoom: 50%;" />

- 电话交换机可以将需要通信的任意两部电话的通信线路接通，且大大减少了需要的电话线数量

- 当电话机的数量增多时，就需要使用很多彼此连接起来的电话交换机来完成全网的交换任务

- 如此就逐渐形成了覆盖全世界的电信网

#### 什么是交换 ？现存的 3 种交换方式

> 从通信资源的分配角度来看，交换（Switching）指的是按照某种方式动态地分配传输线路的资源

##### 1. 电路交换（Circuit Switching）

> 电话交换机接通电话线的方式称为电路交换

- 电路交换的示意图如下（为了简单起见，图中没有对「市话交换机」和「长途电话交换机」做区分）

![image-20220301151942968](https://gitee.com/pj-l/imgs-1/raw/master/image-20220301151942968.png)

- 注意：

	- 「用户线」是电话用户**专用**的

	- 电话交换机之间的拥有大量话路的「中继线」是许多用户**共享**的

- 电路交换的步骤：

	1. **建立连接（分配通信资源）**
		
		例如，在使用电路交换打电话之前，必须先拨号（请求建立连接），当被叫用户听到电话交换机送来的拨号音并摘机后，就从主叫端到被叫端建立起了一条连接；这条连接是一条专用的物理通路，保证了双方通话时所需的通信资源，双方进行通信时这些资源**不会**被其他用户占用

	2. **通话（主叫和被叫之间互通电话）**

		在整个通话期间，上一步建立连接所分配的通信资源始终被占用

	3. **释放连接**

		通话完毕挂机后，电话交换机释放刚才使用的这条专用的物理通路，也就把刚才占用的所有通信资源都归还给了电信网

> 思考：如果使用电路交换来传送计算机数据，是否可行 ？

- 答：
  - 不可行

  - 尽管采用电路交换可以实现计算机之间的数据传送，但是实际工作效率往往很低

  - 这是因为

    - **计算机数据是突发式地出现在传输线路上的**

    - 试想一下，若采用电路交换，当两台计算机之间的通信线路被建立起来之后，若用户正在编辑待传送的文本，则此时所占用的通信资源是暂时未被利用的，且这些通信资源也不能被其他用户利用，宝贵的通信资源就白白被浪费了


> 因此，计算机网络通常采用下面要讲的分组交换 ！

##### 2. 分组交换（Packet Switching）

- 假设下图是因特网的一部分

<img src="https://gitee.com/pj-l/imgs-1/raw/master/image-20220302112544339.png" alt="image-20220302112544339" style="zoom:50%;" />

- 在因特网中，最重要的部件就是分组交换机（即：路由器），它负责将各种网络互连起来，并对接收到的分组进行转发（即：进行分组交换）

- 举个例子，假设主机 H6 的用户要给主机 H2 的用户发送一条消息

<img src="https://gitee.com/pj-l/imgs-1/raw/master/image-20220302114126969.png" alt="image-20220302114126969" style="zoom: 50%;" />

- 通常我们把表示该消息的整块数据称为一个「报文」

- 在发送报文之前，报文会被划分成一个个更小的「等长数据段」，每个数据段的前面都会被加上由必要的控制信息所组成的「首部」，如此就形成了一个「分组」，简称为「包」，首部简称为「包头」

<img src="https://gitee.com/pj-l/imgs-1/raw/master/image-20220302114431665.png" alt="image-20220302114431665" style="zoom: 50%;" />	

> 思考：为什么要添加首部 ？这不是加大了待传输的数据量吗 ？

- 答：

	- 首部中肯定包含了分组的目的地址，否则分组传输路径中的各分组交换机（也就是各路由器）就不知道该如何转发分组了

	- 分组交换机收到一个分组后，先将分组暂时存储下来，再检查其首部，按照首部中的目的地址进行「查表转发」，找到合适的转发接口，通过该接口将分组转发给下一个分组交换机



##### 3. 报文交换（Message Switching）

