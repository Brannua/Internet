- For internet，仅仅实现物理层和数据链路层，是无法实现数据包在网络间的传输的

- 网络层扛起了「实现网络互连」，进而「实现数据包在网络间的传输」的任务

#### 网络层互连设备：路由器

- 下图这些异构型网络如果只需各自内部通信，那只需实现各自的物理层和数据链路层

![image-20220412111723230](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-picgo/image-20220412111723230.png)

- 但是，如果需要将这些网络互连起来，形成一个更大的网络，就需要使用网络层互连设备**路由器**

![image-20220412111853694](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-picgo/image-20220412111853694.png)

- 此外：为简单起见，我们可以不用画出这些网络

![image-20220412112011582](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-picgo/image-20220412112011582.png)

#### 网络层需要解决的主要问题

##### 1、向运输层提供的服务是“可靠传输”还是“不可靠传输” ？

![image-20220412113655097](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-picgo/image-20220412113655097.png)

- 如果网络层不处理（误码、丢包、失序）

  - 则提供的是不可靠传输服务

- 如果网络层处理（误码、丢包、失序）使得接收方能正确地接收到发送方所发送的数据包

  - 则提供的是可靠传输服务

> 不同网络体系结构所提供的服务可能不同

- eg：TCP/IP 体系结构的网际层，提供的是无连接、不可靠的数据报服务

- eg：ATM、帧中继、X.25 的网络层，提供的是面向连接、可靠的虚电路服务

##### 2、网络层寻址问题

> TCP/IP 体系结构的网际层，使用 IP 地址

- 下图标注了网络 N1 上两个路由器接口各自所分配的 IP 地址

  - 它们的前 3 个数是相同的，可以看作它们所在网络的网络编号

  - 它们的第 4 个数不同，用于区分这两个路由器接口

![image-20220412114620756](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-picgo/image-20220412114620756.png)

- 下图标注了网络 N3 上两个路由器接口各自所分配的 IP 地址

  - 它们的前 2 个数是相同的，可以看作它们所在网络的网络编号

  - 它们的后 2 个数不同，用于区分这两个路由器接口

![image-20220412114850668](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-picgo/image-20220412114850668.png)

- 下图标注了网络 N7 上两个路由器接口各自所分配的 IP 地址

  - 它们的第 1 个数是相同的，可以看作它们所在网络的网络编号

  - 它们的后 3 个数不同，用于区分这两个路由器接口

![image-20220412115058578](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-picgo/image-20220412115058578.png)

##### 3、路由选择问题

- 从源站到目的站，数据包往往有多条路径可选

![image-20220412115301744](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-picgo/image-20220412115301744.png)

- 那么：路由器收到数据包后，是依据什么来决定将数据包从自己的哪个接口转发出去的呢 ？

- 依据的是（数据包中的目的地址 & 路由器中的路由表）

![image-20220412115603980](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-picgo/image-20220412115603980.png)

- 但是，一个新的路由器中的路由表是空的，这个路由表的内容是如何建立起来的呢 ？

  - 法一：由用户或网络管理员进行人工配置（只适用于网络拓扑结构不变的小规模互连网）

  - 法二：实现各种路由选择协议 => 由路由器执行路由选择协议中规定的路由选择算法 => 得出路由记录并写入路由表

#### 小结

![image-20220412120232618](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-picgo/image-20220412120232618.png)
